// This file is automatically generated by Keystone, do not modify it manually.
// Modify your Keystone config when you want to change this.

datasource sqlite {
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
  provider          = "sqlite"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id                    String        @id @default(cuid())
  firstName             String        @default("")
  lastName              String        @default("")
  phoneNumbers          String        @default("")
  clerkId               String        @unique @default("")
  email                 String        @unique @default("")
  role                  String?       @default("USER")
  password              String
  permissions           String?       @default("ALL")
  configuration         String?       @default("{}")
  tags                  Tag[]         @relation("Tag_users")
  updatedAt             DateTime?     @updatedAt
  createdAt             DateTime?     @default(now())
  from_Cluster_users    Cluster[]     @relation("Cluster_users")
  from_List_users       List[]        @relation("List_users")
  from_Product_users    Product[]     @relation("Product_users")
  from_Inventory_users  Inventory[]   @relation("Inventory_users")
  from_Invitation_user  Invitation[]  @relation("Invitation_user")
  from_Order_users      Order[]       @relation("Order_users")
  from_Integration_user Integration[] @relation("Integration_user")
}

model Cluster {
  id                       String       @id @default(cuid())
  name                     String       @default("")
  description              String       @default("")
  users                    User[]       @relation("Cluster_users")
  lists                    List[]       @relation("Cluster_lists")
  createdAt                DateTime?    @default(now())
  updatedAt                DateTime?    @updatedAt
  from_List_clusters       List[]       @relation("List_clusters")
  from_Invitation_clusters Invitation[] @relation("Invitation_clusters")
}

model List {
  id                    String       @id @default(cuid())
  name                  String       @default("")
  description           String       @default("")
  tags                  Tag[]        @relation("List_tags")
  clusters              Cluster[]    @relation("List_clusters")
  users                 User[]       @relation("List_users")
  products              Product[]    @relation("List_products")
  items                 Inventory[]  @relation("List_items")
  createdAt             DateTime?    @default(now())
  updatedAt             DateTime?    @updatedAt
  from_Cluster_lists    Cluster[]    @relation("Cluster_lists")
  from_Invitation_lists Invitation[] @relation("Invitation_lists")
}

model Product {
  id                  String    @id @default(cuid())
  name                String    @default("")
  description         String    @default("")
  category            String    @default("")
  sku                 String    @default("")
  barcode             String    @default("")
  attributes          String?   @default("{}")
  isComposite         Boolean   @default(false)
  cost                Float?
  price               Float?
  taxRate             Float?    @default(0)
  reorderLevel        Int?      @default(0)
  unit                String    @default("pcs")
  quantity            Int?      @default(0)
  supplier            String    @default("")
  leadTime            Int?
  status              String?   @default("ACTIVE")
  isHidden            Boolean   @default(false)
  users               User[]    @relation("Product_users")
  tags                Tag[]     @relation("Product_tags")
  bom                 BOM[]     @relation("BOM_composite")
  createdAt           DateTime? @default(now())
  updatedAt           DateTime? @updatedAt
  from_List_products  List[]    @relation("List_products")
  from_Order_products Order[]   @relation("Order_products")
}

model Inventory {
  id                   String    @id @default(cuid())
  name                 String    @default("")
  description          String    @default("")
  batchNumber          String    @default("")
  sku                  String    @unique @default("")
  quantity             Int?      @default(0)
  unit                 String    @default("pcs")
  location             String    @default("")
  expiryDate           DateTime?
  receivedDate         DateTime? @default(now())
  attributes           String?   @default("{}")
  purchasePrice        Float?
  salePrice            Float?
  price                Float?
  status               String?   @default("IN_STOCK")
  supplier             String    @default("")
  isReserved           Boolean   @default(false)
  isDamaged            Boolean   @default(false)
  users                User[]    @relation("Inventory_users")
  tags                 Tag[]     @relation("Inventory_tags")
  bom                  BOM?      @relation("BOM_component")
  createdAt            DateTime? @default(now())
  updatedAt            DateTime? @updatedAt
  from_List_items      List[]    @relation("List_items")
  from_Order_inventory Order[]   @relation("Order_inventory")
}

model Invitation {
  id        String    @id @default(cuid())
  email     String    @default("")
  status    String?   @default("PENDING")
  token     String    @unique @default("")
  lists     List[]    @relation("Invitation_lists")
  clusters  Cluster[] @relation("Invitation_clusters")
  user      User?     @relation("Invitation_user", fields: [userId], references: [id])
  userId    String?   @map("user")
  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  @@index([userId])
}

model Order {
  id          String      @id @default(cuid())
  orderNumber String      @default("")
  status      String?     @default("PENDING")
  users       User[]      @relation("Order_users")
  products    Product[]   @relation("Order_products")
  inventory   Inventory[] @relation("Order_inventory")
  source      String      @default("")
  quantity    Int?        @default(0)
  unit        String      @default("pcs")
  currency    String      @default("")
  createdAt   DateTime?   @default(now())
  updatedAt   DateTime?   @updatedAt
}

model Integration {
  id              String    @id @default(cuid())
  user            User?     @relation("Integration_user", fields: [userId], references: [id])
  userId          String?   @map("user")
  integrationType String    @default("")
  storeUrl        String    @default("")
  apiKey          String    @default("")
  shopId          String    @default("")
  status          String?   @default("PENDING")
  createdAt       DateTime? @default(now())
  updatedAt       DateTime? @updatedAt

  @@index([userId])
}

model Tag {
  id          String      @id @default(cuid())
  name        String      @default("")
  description String      @default("")
  users       User[]      @relation("Tag_users")
  lists       List[]      @relation("List_tags")
  products    Product[]   @relation("Product_tags")
  inventory   Inventory[] @relation("Inventory_tags")
}

model BOM {
  id          String     @id @default(cuid())
  name        String     @default("")
  description String     @default("")
  composite   Product?   @relation("BOM_composite", fields: [compositeId], references: [id])
  compositeId String?    @map("composite")
  component   Inventory? @relation("BOM_component", fields: [componentId], references: [id])
  componentId String?    @unique @map("component")
  quantity    Int        @default(1)
  unit        String     @default("pcs")

  @@index([compositeId])
}
